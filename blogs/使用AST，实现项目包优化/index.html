<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>文章</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="blog-nuxt"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:title" name="og:title" property="og:title" content="blog-nuxt"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="blog-nuxt"><meta data-n-head="ssr" data-hid="og:description" name="og:description" property="og:description" content="## Build Setup"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" data-hid="shortcut-icon" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.5f6a36.png"><link data-n-head="ssr" data-hid="apple-touch-icon" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.5f6a36.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.0576bc8b.json" data-hid="manifest"><link rel="preload" href="/_nuxt/e88f8e6.js" as="script"><link rel="preload" href="/_nuxt/b1d70db.js" as="script"><link rel="preload" href="/_nuxt/87fba30.js" as="script"><link rel="preload" href="/_nuxt/0ec0951.js" as="script"><link rel="preload" href="/_nuxt/f0fcb16.js" as="script"><link rel="preload" href="/_nuxt/2db4bdf.js" as="script"><style data-vue-ssr-id="5f352871:0 517a8dd7:0 7e56e4e3:0 156738d2:0 137fa882:0 8c21cf7a:0 24b1340c:0 718cd39f:0">body#light{--module-bg:rgba(#fff,0.6);--header-fix-bg:rgba(#fff,.8);--module-hover-bg:rgba(#24292e,.12);--module-hover-bg-light-3:rgba(103,118,132,0.12);--module-hover-bg-light-6:rgba(158,169,179,0.12);--code-bg:#f7f7f7;--theme-white:#fff;--theme-black:#24292e;--theme-red-light-1:#d06f67;--border-color:#eee;--text:#666;--text-dividers:#ccc;--text-disabled:#a6a6a6;--text-secondary:#4d4d4d;--text-light-4:#ccc;--text-light-3:#b3b3b3;--text-light-1:grey;--text-dark-1:#4d4d4d}body#dark,body#light{--theme-red:#ca5c54;--theme-primary:#75bfd7;--theme-green:#73b769}body#dark{--module-bg:rgba(#282c35,0.6);--header-fix-bg:rgba(#282c35,.8);--module-hover-bg:rgba(#d3d3d3,.12);--module-hover-bg-light-3:hsla(0,0%,100%,0.12);--module-hover-bg-light-6:hsla(0,0%,100%,0.12);--code-bg:#21252c;--theme-white:#282c35;--theme-black:#d3d3d3;--theme-red-light-1:#d06f67;--border-color:#696969;--text:silver;--text-dividers:#fff;--text-disabled:#fff;--text-secondary:#a7a7a7;--text-light-4:#fff;--text-light-3:#fff;--text-light-1:#dadada;--text-dark-1:#a7a7a7}/*! sanitize.css v5.0.0 | CC0 License | github.com/jonathantneal/sanitize.css */*,:after,:before{background-repeat:no-repeat;box-sizing:inherit}:after,:before{text-decoration:inherit;vertical-align:inherit}html{box-sizing:border-box;cursor:default;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}article,aside,footer,header,nav,section{display:block}body{margin:0}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1.5em 0}hr{box-sizing:content-box;height:0;overflow:visible}nav ol,nav ul{list-style:none}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}::-moz-selection{background-color:#b3d4fc;color:#000;text-shadow:none}::selection{background-color:#b3d4fc;color:#000;text-shadow:none}audio,canvas,iframe,img,svg,video{vertical-align:middle}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg{fill:currentColor}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{margin:0}button,input,select,textarea{color:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto;resize:vertical}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[tabindex],a,area,button,input,label,select,summary,textarea{touch-action:manipulation}[hidden]{display:none}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-hidden=false][hidden]:not(:focus){clip:rect(0,0,0,0);display:inherit;position:absolute}[aria-disabled]{cursor:default}html{color:var(--text);background:var(--theme-white)}blockquote,body,button,code,dd,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,input,legend,li,ol,p,pre,select,td,textarea,th,ul{margin:0;padding:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}address,button,caption,cite,code,dfn,em,input,optgroup,option,select,textarea,th,var{font:inherit}li{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}abbr,acronym{border:0;font-feature-settings:normal;font-variant:normal}sub,sup{vertical-align:baseline}a{text-decoration:none;color:inherit}img{border:0}legend{color:var(--theme-black)}input,input:focus{-webkit-outline:none;-khtml-outline:none;-moz-outline:none;-ms-outline:none;-o-outline:none;outline:0}input[type=date],input[type=datetime-local],input[type=datetime],input[type=email],input[type=month],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=time],input[type=url],input[type=week],select,textarea{caret-color:var(--theme-black);background:var(--theme-white);color:var(--text);display:inline-block;padding:.3rem;vertical-align:middle;border:none;outline:0;-webkit-appearance:none}[contenteditable]{caret-color:var(--theme-black)}input[type=color]{background:var(--theme-white);display:inline-block;vertical-align:middle}input:not([type]){-webkit-appearance:none;background-clip:padding-box;display:inline-block;text-align:left}input:not([type]):focus,input[type=color]:focus,input[type=date]:focus,input[type=datetime-local]:focus,input[type=datetime]:focus,input[type=email]:focus,input[type=month]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=time]:focus,input[type=url]:focus,input[type=week]:focus,select:focus,textarea:focus{border-color:var(--theme-primary)}input[type=checkbox]:focus,input[type=file]:focus,input[type=radio]:focus{outline:1px thin var(--text-light-4)}input:not([type])[disabled],input[type=color][disabled],input[type=date][disabled],input[type=datetime-local][disabled],input[type=datetime][disabled],input[type=email][disabled],input[type=month][disabled],input[type=number][disabled],input[type=password][disabled],input[type=search][disabled],input[type=tel][disabled],input[type=text][disabled],input[type=time][disabled],input[type=url][disabled],input[type=week][disabled],select[disabled],textarea[disabled]{background-color:var(--text-light-4);color:var(--text-dark-1);cursor:not-allowed}input[readonly],select[readonly],textarea[readonly]{border-color:var(--text-light-4);color:var(--text-dark-1)}input:focus:invalid,select:focus:invalid,textarea:focus:invalid{border-color:var(--theme-red-light-1)!important}input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{box-shadow:inset 0 0 0 1000px #e6e6e6}select{-webkit-appearance:menulist-button;vertical-align:sub}select[multiple]{height:auto}label{line-height:2}fieldset{border:0;margin:0;padding:.5rem 0}legend{border-bottom:1px solid var(--border-color);color:var(--text);display:block;margin-bottom:.5rem;padding:.5rem 0;width:100%}textarea{background:var(--theme-white);display:block;max-width:100%;vertical-align:middle}button,input[type=reset],input[type=submit]{display:inline-block;padding:.5rem 1rem;border:1px solid var(--border-color);border-radius:4px;text-align:center;vertical-align:middle;background:0 0;white-space:nowrap;cursor:pointer}button::-moz-focus-inner,input[type=reset]::-moz-focus-inner,input[type=submit]::-moz-focus-inner{padding:0}button:hover,input[type=reset]:hover,input[type=submit]:hover{border-color:var(--theme-black)}button:active,input[type=reset]:active,input[type=submit]:active{outline-offset:-2px}button:focus,input[type=reset]:focus,input[type=submit]:focus{outline:0}button:disabled,input[type=submit]:disabled{color:var(--text-light-3);cursor:not-allowed}.slide-down-enter-active{transition:all .4s ease}.slide-down-leave-active{transition:all .4s cubic-bezier(1,.5,.8,1)}.slide-down-enter,.slide-down-leave-active{transform:translateY(20px);opacity:0}.slide-down-move{transition:all .4s}.slide-down-leave-active{position:absolute!important;width:100%}.slide-up-enter-active{transition:all .5s ease .3s}.slide-up-leave-active{transition:all .5s ease}.slide-up-enter,.slide-up-leave-active{transform:translateY(-20px);opacity:0}.slide-up-move{transition:all .5s}.slide-left-enter-active{transition:all .5s ease}.slide-left-leave-active{transition:all .5s cubic-bezier(.55,0,.1,1)}.slide-left-enter,.slide-left-leave-active{transform:translateX(20px);opacity:0}.slide-left-move{transition:all .5s}.slide-right-enter-active{transition:all .5s ease}.slide-right-leave-active{transition:all .5s cubic-bezier(.55,0,.1,1)}.slide-right-enter{transform:translateX(-20px);opacity:0}.slide-right-leave-active{transform:translateX(20px);opacity:0}.slide-right-move{transition:all .5s}.list-enter-active{transition:all .5s ease-in-out}.list-leave-active{transition:all .2s ease;opacity:0}.list-enter{transform:translateY(20px);opacity:0}.list-move{transition:all .5s}.list-leave-active{position:absolute;width:100%}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-active{opacity:0}.fade-move{transition:transform .3s}.fade-leave-active{position:absolute}.btn-enter-active,.btn-leave-active{transition:all .5s}.btn-enter,.btn-leave-active{opacity:0;transform:translateX(30px)}.btn-move{transition:all .5s}.btn-leave-active{position:absolute}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_376001_dz5p2ajemat.eot);src:url(//at.alicdn.com/t/font_376001_dz5p2ajemat.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_376001_dz5p2ajemat.woff2) format("woff2"),url(//at.alicdn.com/t/font_376001_dz5p2ajemat.woff) format("woff"),url(//at.alicdn.com/t/font_376001_dz5p2ajemat.ttf) format("truetype"),url(//at.alicdn.com/t/font_376001_dz5p2ajemat.svg#iconfont) format("svg")}.iconfont{font-family:iconfont!important;font-size:1rem;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-comments:before{content:"\e6e4"}.icon-time:before{content:"\e631"}.icon-like:before{content:"\e6e5"}.icon-icon:before{content:"\e608"}.icon-github:before{content:"\e824"}.icon-boke:before{content:"\e63e"}.icon-tag:before{content:"\e815"}.icon-close:before{content:"\e63c"}.icon-user:before{content:"\e600"}.icon-music:before{content:"\e6f6"}.icon-juejin:before{content:"\e601"}.icon-weibo:before{content:"\e627"}.icon-zhihu:before{content:"\e634"}.icon-twitter:before{content:"\ec9c"}.icon-sf:before{content:"\e602"}.icon-csdn:before{content:"\e60d"}.icon-stackoverflow:before{content:"\e825"}.icon-coffee:before{content:"\e64f"}.icon-list:before{content:"\e6e6"}.icon-home:before{content:"\e603"}.icon-read:before{content:"\e666"}.icon-search:before{content:"\e60e"}.icon-hero:before{content:"\e625"}.icon-map:before{content:"\e66e"}.icon-date:before{content:"\e862"}.icon-notice:before{content:"\e604"}.icon-count:before,.icon-message:before{content:"\e60f"}.icon-set:before{content:"\e610"}.icon-write:before{content:"\e68f"}.icon-article:before{content:"\e60a"}.icon-delete:before{content:"\e60c"}.icon-release:before{content:"\e928"}.icon-edit:before{content:"\e66b"}.icon-linux:before{content:"\e635"}.icon-internet:before{content:"\e628"}.icon-windows:before{content:"\e681"}.icon-unix:before{content:"\e607"}.icon-wechat:before{content:"\e694"}.icon-phone:before{content:"\e621"}.icon-android:before{content:"\e605"}.icon-descript:before{content:"\e612"}.icon-mac:before{content:"\e701"}.icon-qzone:before{content:"\e609"}.icon-renren:before{content:"\e77d"}.icon-google-plus:before{content:"\e6f4"}.icon-link:before{content:"\e61c"}.icon-douban:before{content:"\e796"}.icon-linkedin:before{content:"\e64b"}.icon-evernote:before{content:"\e7f9"}.icon-facebook:before{content:"\e6e2"}.icon-email:before{content:"\e63d"}.icon-arrow-up:before{content:"\e611"}.icon-code:before{content:"\e6e8"}.icon-image:before{content:"\e614"}.icon-emoji:before{content:"\e613"}.icon-eye:before{content:"\e615"}.icon-zan:before{content:"\e65e"}.icon-reply:before{content:"\e61f"}.icon-cancel:before{content:"\e61d"}.icon-release:before{content:"\e723"}.icon-setting:before{content:"\e8bd"}.icon-success:before{content:"\e62a"}.icon-category:before{content:"\e616"}.icon-sitemap:before{content:"\e617"}.icon-music-pause:before{content:"\e65b"}.icon-music-play:before{content:"\e65f"}.icon-music-prev:before{content:"\e65c"}.icon-music-next:before{content:"\e65a"}.icon-music-volume:before{content:"\e65d"}.icon-music-muted:before{content:"\e659"}.icon-download:before{content:"\e626"}.icon-dark:before{content:"\e61a"}.icon-light:before{content:"\e61b"}.icon-hot:before{content:"\e6a0"}.icon-think:before{content:"\e61e"}body,html{margin:0;color:var(--text);letter-spacing:.5px;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;font-size:15px;font-weight:400;line-height:1.4;-webkit-font-smoothing:antialiased}body{padding:5rem 0 0}body,body.mobile{background:var(--theme-white)}body.mobile{overflow-x:hidden;padding:0;font-size:14px}code,pre{font-family:"Roboto Mono",Monaco,courier,monospace;-webkit-font-smoothing:initial;-moz-osx-font-smoothing:initial}*,:hover{transition:background-color .1s linear,margin .25s linear,opacity .25s linear,filter .25s linear,visibility .25s linear,transform .25s linear,border-color .25s linear}.container{width:45rem;margin:0 auto}.line{content:"";position:absolute;left:0;right:0;height:1px;color:var(--border-color);background:currentColor}.clearfix:after{content:"";display:block;height:0;clear:both;visibility:hidden}#share.article-share>.share-box{opacity:.6}#share.article-share>.share-box:hover{opacity:1}#share.article-share>.share-box>.share-link{width:calc(8.33333% - .40792em);height:2.2em;line-height:2.3em;background-color:var(--border-color);margin-right:.445em}#share.article-share>.share-box>.share-link>.iconfont{font-size:1.3em}#share.article-share>.share-box>.share-link:last-child{margin-right:0}.markdown-content a{font-weight:700;margin:0 .1rem}.markdown-content a.image-link{margin:0}.markdown-content a:hover{text-decoration:underline}.markdown-content .image-package{text-align:center;width:92%;margin:0 auto .5rem}.markdown-content .image-package .img-caption{display:none}.markdown-content img{max-width:100%;margin:.3rem auto;display:block;text-align:center;border-radius:4px;transition:all .25s;cursor:default!important}.markdown-content img.img-pop{cursor:zoom-in}.markdown-content p{line-height:1.4rem;margin-bottom:.3rem}.markdown-content p.text-center{text-align:center}.markdown-content p.text-right{text-align:right}.markdown-content h1,.markdown-content h2,.markdown-content h3,.markdown-content h4,.markdown-content h5,.markdown-content h6{margin:.3rem 0;padding-left:0;line-height:1.4rem;font-weight:700;text-indent:0}.markdown-content h1:target,.markdown-content h2:target,.markdown-content h3:target,.markdown-content h4:target,.markdown-content h5:target,.markdown-content h6:target{padding-top:4.5rem}.markdown-content hr{height:.1rem;background:var(--text);border:0}.markdown-content blockquote{padding:0 1rem;margin-bottom:.3rem;color:#6a737d;border-left:.25rem solid #dfe2e5}.markdown-content blockquote p{text-indent:0}.markdown-content blockquote p:first-child{margin-top:0}.markdown-content blockquote p:last-child{margin-bottom:0}.markdown-content ul{list-style-type:square}.markdown-content ol,.markdown-content ul{padding-left:2rem;margin-bottom:.3rem}.markdown-content ol>li,.markdown-content ul>li{line-height:1.4rem;padding:.5rem;list-style-type:disc}.markdown-content ol>li>p,.markdown-content ul>li>p{text-indent:0}.markdown-content ol>li>ul li,.markdown-content ul>li>ul li{list-style-type:circle}.markdown-content ol>li>ul:last-child,.markdown-content ul>li>ul:last-child{margin-bottom:0}.markdown-content ul{list-style:disc}.hr{display:inline-block;width:2px;height:2px;background:#aab2bd;margin:4px .6rem}a{-webkit-tap-highlight-color:transparent}::-webkit-input-placeholder{color:var(--text-light-3);font-size:1rem}:-moz-placeholder,::-moz-placeholder{color:var(--text-light-3);font-size:1rem}:-ms-input-placeholder{color:var(--text-light-3);font-size:1rem}::-webkit-scrollbar{width:.5rem;height:.5rem;background:hsla(0,0%,100%,.6)}::-webkit-scrollbar-track{border-radius:0}::-webkit-scrollbar-thumb{border-radius:0;background-color:rgba(95,95,95,.4);-webkit-transition:all .2s;transition:all .2s;border-radius:.5rem}::-webkit-scrollbar-thumb:hover{background-color:rgba(95,95,95,.7)}.article-content-thumb .progress-image{background-color:var(--module-bg);background-size:cover;background-repeat:no-repeat;position:relative}.article-content-thumb .progress-image .progress-image-fill{padding-top:20%}.article-content-thumb .progress-image img{position:absolute;opacity:0;top:0;left:0;width:100%;transition:opacity 1s linear}.article-content-thumb .progress-image img.image-small{filter:blur(8px);transform:scale(1)}.article-content-thumb .progress-image img.image-large{display:none;z-index:1}.article-content-thumb .progress-image img.loaded{opacity:1}.article-content-thumb .progress-image img.hidden{opacity:0}.gutter pre{color:#999}pre{color:var(--text)}pre .constant,pre .function .keyword{color:#0092db}pre .attribute,pre .keyword{color:#e96900}pre .literal,pre .number{color:#ae81ff}pre .change,pre .clojure .built_in,pre .flow,pre .lisp .title,pre .nginx .title,pre .tag,pre .tag .title,pre .tex .special,pre .winutils{color:#2973b7}pre .class .title{color:green}pre .regexp,pre .symbol,pre .symbol .string,pre .value{color:#42b983}pre .title{color:#a6e22e}pre .addition,pre .apache .cbracket,pre .apache .tag,pre .attr_selector,pre .built_in,pre .django .filter .argument,pre .django .template_tag,pre .django .variable,pre .envvar,pre .haskell .type,pre .javadoc,pre .preprocessor,pre .prompt,pre .pseudo,pre .ruby .class .parent,pre .smalltalk .array,pre .smalltalk .class,pre .smalltalk .localvars,pre .sql .aggregate,pre .stream,pre .string,pre .subst,pre .tag .value,pre .tex .command{color:#42b983}pre .apache .sqbracket,pre .comment,pre .deletion,pre .doctype,pre .java .annotation,pre .pi,pre .python .decorator,pre .shebang,pre .template_comment,pre .tex .formula{color:#b3b3b3}pre .coffeescript .javascript,pre .javascript .xml,pre .tex .formula,pre .xml .cdata,pre .xml .css,pre .xml .javascript,pre .xml .vbscript{opacity:.5}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.app>.app-aside[data-v-7f17d539]{position:fixed;top:0;left:0;z-index:9999;height:100%;width:60%;background:var(--theme-white);-khtml-transform:translateX(-100%);transform:translateX(-100%);transition:all .3s ease-out}.app>.app-aside>.mobile-aside[data-v-7f17d539]{opacity:0;transition:all .3s ease-out;-khtml-transform:scale(.8);transform:scale(.8)}.app>.app-aside.open[data-v-7f17d539]{-khtml-transform:translateX(0);transform:translateX(0)}.app>.app-aside.open>.mobile-aside[data-v-7f17d539]{opacity:1;-khtml-transform:scale(1);transform:scale(1)}.app>.app-main[data-v-7f17d539]{transition:all .3s ease-out}.app>.app-main>.main-container[data-v-7f17d539]{min-height:calc(100vh - 196px);margin-top:1rem}.app>.app-main>.main-container.mobile[data-v-7f17d539]{min-height:calc(100vh - 56px)}.app>.app-main.open[data-v-7f17d539]{transform:translateX(60%)}.content-left[data-v-7f17d539]{position:relative;width:45rem;float:left;transition:all .3s cubic-bezier(1,.5,.8,1)}.content-left.full-page[data-v-7f17d539],.content-left.mobile-layout[data-v-7f17d539]{width:100%;transition:width .5s cubic-bezier(1,.5,.8,1)}.content-left.mobile-layout[data-v-7f17d539]{width:100%;margin:0;padding:4.5rem 1rem 1rem}.content-right[data-v-7f17d539]{width:16rem;float:right}.mobile[data-v-7f17d539]{width:100%}header{position:fixed;top:0;z-index:999;width:100%;height:4rem;transform:translateY(0)}header,header:hover{background:var(--theme-white)}header.fixed{transform:translateY(-100%)}header.darken{-ms-box-shadow:0 1px 2px rgba(0,0,0,.05);-o-box-shadow:0 1px 2px rgba(0,0,0,.05);box-shadow:0 1px 2px rgba(0,0,0,.05)}header>.header{position:relative;display:flex;justify-content:space-between;align-items:center;min-width:45rem;height:4rem;padding:0 1.5rem;line-height:4rem}header>.header>.header-left{display:flex}header>.header>.header-left>.logo{position:absolute;left:50%;height:4rem;line-height:4rem;-khtml-transform:translateX(-50%);transform:translateX(-50%)}header>.header>.header-left>.logo a{color:var(--theme-black);font-size:2rem}header>.header>.header-left>.logo a img{vertical-align:text-bottom}header nav{display:flex}header nav>div.nav-item{position:relative;padding:0 1.5rem;color:var(--text-light-3)}header nav>div.nav-item>i{margin-right:.5rem}header nav>div.nav-item a:hover{color:var(--theme-black)}header nav>div.nav-item:hover>.sub-nav{display:block}header nav>div.nav-item .sub-nav{display:none;position:absolute;top:4rem;width:100%;cursor:pointer}header nav>div.nav-item .sub-nav .sub-nav-item{padding-left:.8rem;background:var(--code-bg)}header nav>div.nav-item .sub-nav .sub-nav-item:hover{background:var(--module-hover-bg-light-3)}header nav a.link-active{color:var(--theme-black)}header .header-right{width:200px}header .search-box{display:flex;align-items:center;justify-content:flex-end;padding:.5rem;width:100%;height:40px;cursor:pointer;-khtml-transform:translateZ(0);transform:translateZ(0)}header .search-box>.search{position:relative;width:1rem;height:1rem;border:2px solid var(--theme-black);transition:all .3s ease .15s;border-radius:.9rem;cursor:pointer}header .search-box>.search:after{top:90%;left:100%;width:5px;height:2px;background-color:var(--theme-black);border-radius:1px;content:"";position:absolute;display:block;transition:width .15s ease .45s;-khtml-transform:rotate(45deg);transform:rotate(45deg);-khtml-transform-origin:top left;transform-origin:top left}header .search-box>.search>input{position:absolute;width:100%;height:100%;font-size:14px;line-height:38px;opacity:0;background-color:transparent;color:var(--text);transition:opacity .15s ease}header .search-box>.search>.eks{display:block;position:absolute;top:50%;right:2px;z-index:20;width:16px;height:16px;cursor:pointer;-khtml-transform:translateY(-50%);transform:translateY(-50%)}header .search-box>.search>.eks:after,header .search-box>.search>.eks:before{content:"";position:absolute;display:block;right:1px;height:2px;width:0;border-radius:1px;transition:all .25s ease}header .search-box>.search>.eks:before{top:0;background-color:var(--theme-black);-khtml-transform:rotate(-45deg);transform:rotate(-45deg);-khtml-transform-origin:top right;transform-origin:top right;transition-delay:.1s}header .search-box>.search>.eks:after{bottom:0;background-color:var(--theme-black);-khtml-transform:rotate(45deg);transform:rotate(45deg);-khtml-transform-origin:bottom right;transform-origin:bottom right;transition-delay:0s}header .search.open{width:100%;border:none;transition-delay:.1s}header .search.open:after{width:0;transition-delay:0s}header .search.open>input{position:absolute;padding:.5rem 2.5rem .5rem .5rem;line-height:1rem;opacity:1;transition-delay:.05s}header .search.open>.eks{right:10px}header .search.open>.eks:after,header .search.open>.eks:before{width:15px}header .search.open>.eks:before{top:2px;right:0;transition-delay:.25s}header .search.open>.eks:after{right:10px;bottom:2px;width:8px;transition-delay:.3s}.article-container{padding-bottom:100px}.article-container .article-header{margin-bottom:30px}.article-container .title{font-size:2rem;color:var(--theme-black)}.article-container .article-img{width:660px;height:330px;-o-object-fit:cover;object-fit:cover;margin-bottom:30px}.article-container .nuxt-content h1>a,.article-container .nuxt-content h2>a,.article-container .nuxt-content h3>a,.article-container .nuxt-content h4>a,.article-container .nuxt-content h5>a{display:none}.article-container .nuxt-content img{width:100%}.article-container .nuxt-content p{line-height:1.8rem;margin:1.5rem 0}.article-container .nuxt-content h2{font-weight:700;font-size:24px;margin:1.5rem 0}.article-container .nuxt-content h3{font-weight:700;font-size:20px;margin:1.2rem 0}.article-container .nuxt-content a{color:#07aab2}.article-container .icon.icon-link{display:inline-block;width:20px;height:20px;background-size:20px 20px}footer[data-v-0b1a2a10]{margin-top:1rem;padding:1rem 0;background:var(--theme-white);border-top:1px solid var(--border-color);color:var(--text)}footer>.container[data-v-0b1a2a10]{display:flex;justify-content:flex-end}footer>.container.center[data-v-0b1a2a10]{justify-content:center}footer>.container>.mune[data-v-0b1a2a10],footer>.container>ul[data-v-0b1a2a10]{padding:.5rem 0}footer>.container>.mune[data-v-0b1a2a10]{padding:.5rem 1rem;border-top:1px solid var(--border-color)}footer.mobile[data-v-0b1a2a10]{display:none;margin-top:0;padding:0 1rem}footer.mobile>.container[data-v-0b1a2a10]{width:100%}.scoll-aside[data-v-5889ccfc]{position:fixed;right:0;bottom:8rem}.scoll-aside>.scoll-btn[data-v-5889ccfc]{display:block;width:3rem;height:3rem;margin-bottom:.5rem;color:#5ab95c;background:var(--module-bg);text-align:center;line-height:2.7rem;box-shadow:0 2px 4px 0 rgba(0,0,0,.14);border-left-color:solid;border-bottom-color:var(--border-color);border-right-color:solid;border-top-color:1px;cursor:pointer}.scoll-aside>.scoll-btn.theme[data-v-5889ccfc]{color:var(--theme-black)}.scoll-aside>.scoll-btn.theme i[data-v-5889ccfc]{font-size:1.6rem}.scoll-aside>.scoll-btn.email[data-v-5889ccfc]{color:#d9544e}.scoll-aside.mobile[data-v-5889ccfc]{width:3rem;right:0;bottom:3rem}.scoll-aside.mobile>.scoll-btn[data-v-5889ccfc]{width:2rem;height:2rem;line-height:2rem}</style>
    <!-- <script data-ad-client="ca-pub-8918100374180146" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
  </head>
  <body id="dark">
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="app" data-v-7f17d539><!----> <div class="app-main" data-v-7f17d539><div class="head-box" data-v-7f17d539 data-v-7f17d539><header class="darken" data-v-7f17d539><div class="header"><div class="header-left"><div class="logo"><a href="/" class="nuxt-link-active"><img src="/_nuxt/img/logo.2bbb1ad.png" alt="" width="36"></a></div> <nav><div class="nav-item"><a href="/">
              文章
            </a> <div class="sub-nav"><div class="sub-nav-item"><span>
                      全部
                    </span></div><div class="sub-nav-item"><span>
                      码农
                    </span></div><div class="sub-nav-item"><span>
                      思考
                    </span></div><div class="sub-nav-item"><span>
                      读书
                    </span></div></div></div><div class="nav-item"><a href="/about">
              关于我
            </a> <div class="sub-nav"><!----></div></div></nav></div> <div class="header-right"><div class="search-box"><div class="search"><input placeholder="search..." maxlength="10"> <div class="eks"></div></div></div></div></div></header></div> <div class="container clearfix main-container" data-v-7f17d539><div class="content-left full-page" data-v-7f17d539><article class="article-container" data-v-7f17d539><div class="article-header"><p class="title">使用AST，实现项目包优化</p> <span>2021.01.22</span></div> <!----> <div class="nuxt-content"><h2 id="问题背景"><a href="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>问题背景</h2>
<p>我们原来项目中请求API的代码是用公司现有的脚本工具生成的，其原理就是通过 node 访问 swagger 上后端开发暴露的api，根据约定的规则自动生成api请求的代码，如下所示：</p>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token comment">// api.js</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> moduleA</span> <span class="token keyword module">from</span> <span class="token string">'./moduleA.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> moduleB</span> <span class="token keyword module">from</span> <span class="token string">'./moduleB.js'</span><span class="token punctuation">;</span>
<span class="token comment">//... 省略很多module</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
    moduleA<span class="token punctuation">,</span>
    moduleB<span class="token punctuation">,</span>
    <span class="token comment">//....省略很多module</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//moduleA.js</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">methodA</span> <span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">'/carEquity/entry.json'</span><span class="token punctuation">,</span>
        opts<span class="token operator">:</span> opts
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">methodB</span> <span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">'/carEquity/entry.json'</span><span class="token punctuation">,</span>
        opts<span class="token operator">:</span> opts
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//... 省略很多method</span>

<span class="token comment">//moduleB.js</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">methodA</span> <span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">'/carEquity/entry.json'</span><span class="token punctuation">,</span>
        opts<span class="token operator">:</span> opts
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">methodB</span> <span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> <span class="token string">'/carEquity/entry.json'</span><span class="token punctuation">,</span>
        opts<span class="token operator">:</span> opts
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//... 省略很多method</span>
</code></pre></div>
<p>其好处就是：可以一键同步api，自动生成代码省去我们的编码工作，api声明和调用规范统一。
但是它也带来了比较严重的弊端，即无论这个API方法是否被用到，它都会被打包到项目中，增大了项目的体积，影响应用的首屏启动速度。还有就是模块这种设计模式不支持代码分割，调用者必须如下的导入方式才能才能调用API：</p>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token comment">// page.js</span>
<span class="token keyword module">import</span> <span class="token constant">API</span> <span class="token keyword module">from</span> <span class="token string">'@/api'</span><span class="token punctuation">;</span>
<span class="token constant">API</span><span class="token punctuation">.</span><span class="token property-access">moduleA</span><span class="token punctuation">.</span><span class="token method function property-access">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">API</span><span class="token punctuation">.</span><span class="token property-access">moduleB</span><span class="token punctuation">.</span><span class="token method function property-access">methodB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">API</span><span class="token punctuation">.</span><span class="token property-access">moduleA</span><span class="token punctuation">.</span><span class="token method function property-access">methodC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>可以见上述这种方式不但调用繁琐，而且也不能启用 webpack 的 tree shaking 只打包使用到的方法。</p>
<h2 id="解决方案"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>解决方案</h2>
<p>当然重构代码是一种方法，但是项目代码量已经非常盘大，如果这时候重构原来的api模块代码工作量将会非常大，这无疑是不可取的方案。但是改代码确是唯一的解决方案，那么有没有途径可以在打包的时候自动改掉原来的代码写法呢，而不用手动改原来的代码。</p>
<p>当然有了，babel插件提供了可以处理AST的功能，可以在babel-loader 处理的时候修改其抽象语法树，改变其代码的写法。还不了解babel 相关知识的朋友可以看下<a href="https://www.babeljs.cn/" rel="nofollow noopener noreferrer" target="_blank">官方文档</a>
主要目的就是将上述的 page.js 的中的代码改写成如下的形式:</p>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> methodA<span class="token punctuation">,</span> methodC <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@/api/moduleA.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> methodB <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@/api/moduleB.js'</span><span class="token punctuation">;</span>
<span class="token function">methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">methodB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">methodC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div>
<p>写成这种形式就可以被webpack的 tree shaking 所处理，只会打包用到的代码。</p>
<h2 id="处理步骤与核心代码"><a href="#%E5%A4%84%E7%90%86%E6%AD%A5%E9%AA%A4%E4%B8%8E%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>处理步骤与核心代码</h2>
<h3 id="处理步骤"><a href="#%E5%A4%84%E7%90%86%E6%AD%A5%E9%AA%A4" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>处理步骤</h3>
<ul>
<li>1、找到导入的 API 变量名</li>
<li>2、找到调用的API的模块名称，并收集每个模块下所调用的方法，moduleA: methodA,methodC</li>
<li>3、替换调用的方法，即替换函数表达式，API.moduleA.methodA() 换成 methodA()</li>
<li>4、 删掉原来的import API 的语句，改成从对应的模块里导出使用到的方法。</li>
</ul>
<h3 id="核心代码"><a href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>核心代码</h3>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token comment">// 存储API的变量名</span>
<span class="token keyword">let</span> variableName <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token comment">// 存储用到的模块以及对应的方法，格式如下：</span>
<span class="token comment">/*{
    moduleA: ['methodA1', 'methodA2'],
    moduleB: ['methodB1', 'methodB2'],
}*/</span>
<span class="token keyword">let</span> moduleMap <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getAPICallInfo</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token property-access">object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">getAPICallInfo</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token property-access">object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">return</span> result <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span><span class="token property-access">property</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> obj<span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> variableName <span class="token operator">?</span> variableName <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">babel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
        types<span class="token operator">:</span> t
    <span class="token punctuation">}</span> <span class="token operator">=</span> babel<span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
        visitor<span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token function"><span class="token maybe-class-name">ImportDeclaration</span></span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token comment">// 获取导入的 API 变量名</span>
              <span class="token keyword">const</span> specifier <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">specifiers</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
              <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> pathValue <span class="token punctuation">}</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">source</span><span class="token punctuation">;</span>
              <span class="token comment">// 约定 importSource 必须为 @/api</span>
              <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>pathValue <span class="token operator">===</span> <span class="token string">'@/api'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 得到模块的变量名，先保存下来</span>
                variableName <span class="token operator">=</span> specifier<span class="token punctuation">.</span><span class="token property-access">local</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">;</span>
                <span class="token comment">//移除相应的import语句</span>
                path<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function"><span class="token maybe-class-name">CallExpression</span></span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// 获取api方法的调用链，API-moduleA-methodA，如果不是API调用的表达式则返回空</span>
              <span class="token keyword">const</span> apiCallInfo <span class="token operator">=</span> <span class="token function">getAPICallInfo</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">callee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>apiCallInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> moduleName<span class="token punctuation">,</span> methodName<span class="token punctuation">]</span> <span class="token operator">=</span> apiCallInfo<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 调用信息先保存下来，方便到最后统一添加import</span>
                <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    moduleMap<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
                    moduleMap<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>methodName<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 替换表达式</span>
                <span class="token comment">// API.moduleA.methodA() ---> moduleA_methodA()</span>
                <span class="token comment">// 前面加个模块名作为前缀，主要就是为了防止，不同模块存在相同的方法名</span>
                path<span class="token punctuation">.</span><span class="token method function property-access">replaceWith</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">CallExpression</span></span><span class="token punctuation">(</span>
                    t<span class="token punctuation">.</span><span class="token method function property-access">identifier</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>moduleName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        path<span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">arguments</span>
                <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token maybe-class-name">Program</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token function">exit</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token comment">// 在遍历退出前统一把import语句添加在代码的最前面</span>
                  <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">entries</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>moduleName<span class="token punctuation">,</span> methods<span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token arrow operator">=></span><span class="token punctuation">{</span>
                    <span class="token keyword">const</span> importSource <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../api/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>moduleName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                    <span class="token comment">// import声明</span>
                    <span class="token keyword">const</span> specifiers <span class="token operator">=</span> methods<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">method</span> <span class="token arrow operator">=></span>
                        t<span class="token punctuation">.</span><span class="token method function property-access">importSpecifier</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token method function property-access">identifier</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>moduleName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span><span class="token method function property-access">identifier</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
                    <span class="token comment">//创建导入语句</span>
                    <span class="token keyword">const</span> importDeclaration <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token method function property-access">importDeclaration</span><span class="token punctuation">(</span>specifiers<span class="token punctuation">,</span>t<span class="token punctuation">.</span><span class="token method function property-access">stringLiteral</span><span class="token punctuation">(</span>importSource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 插入到代码最前面</span>
                    path<span class="token punctuation">.</span><span class="token method function property-access">unshiftContainer</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">,</span>importDeclaration<span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span>
                  moduleMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div>
<p>经过该babel插件打包后结果代码如下所示：</p>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> methodA <span class="token keyword module">as</span> moduleA_methodA<span class="token punctuation">,</span> methodC <span class="token keyword module">as</span> moduleA_methodC<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@/api/moduleA.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> methodB <span class="token keyword module">as</span> moduleB_methodB <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'@/api/moduleB.js'</span><span class="token punctuation">;</span>
<span class="token function">moduleA_methodA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">moduleB_methodB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">moduleA_methodC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h2 id="遗留问题"><a href="#%E9%81%97%E7%95%99%E9%97%AE%E9%A2%98" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>遗留问题</h2>
<p>虽然我们使用babel 初步完成了包优化，上述的代码还是有点局限性的，例如 import 的source 必须要写成‘@/api’的形式，而不支持相对路径（'../../api'）的写法。还有就是要求API 里定义的模块名称和模块文件名称不一致也会出现问题，例如：</p>
<div class="nuxt-content-highlight"><pre class="language-js line-numbers"><code><span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> moduleA</span> <span class="token keyword module">from</span> <span class="token string">'./moduleA.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> moduleB</span> <span class="token keyword module">from</span> <span class="token string">'./moduleB.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token constant">C</span> <span class="token keyword module">from</span> <span class="token string">'./moduleC.js'</span><span class="token punctuation">;</span>
<span class="token comment">//... 省略很多module</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
    moduleA<span class="token punctuation">,</span>
    moduleB<span class="token punctuation">,</span>
    <span class="token constant">C</span><span class="token punctuation">,</span> <span class="token comment">// 该命名就会导致出错</span>
    <span class="token comment">//....省略很多module</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>针对这些问题，除了批量替换和规范约定外，还是可以写一个eslint插件，自定义校验该语法，如果发现不合理的写法可以直接报错。</p></div></article></div></div> <footer data-v-0b1a2a10 data-v-7f17d539 data-v-7f17d539><div class="container" data-v-0b1a2a10><p class="icp" data-v-0b1a2a10><time data-v-0b1a2a10>©2022</time> <span class="hr" data-v-0b1a2a10></span> <a href="mailto:superzhou7@gmail.com" _target="_blank" data-v-0b1a2a10>邮箱</a> <span class="hr" data-v-0b1a2a10></span> <a href="https://github.com/zhoufeifan" _target="_blank" data-v-0b1a2a10>GitHub</a></p></div></footer></div> <div class="scoll-aside" data-v-5889ccfc data-v-7f17d539></div></div></div></div><script>window.__NUXT__=function(e,a,p,t,l,s,y,r,c,u,v,i,o,n,m,d,h,g,N,A,E,b,f,B,k,I,w,L,x,C,j,P,U,S,_,T,H,q,D,F,z,M,V,W,O,R,X,Z,$,G,J,K,Q,Y,ee,ae,pe,te,le,se,ye,re,ce,ue,ve,ie,oe,ne,me,de,he,ge,Ne,Ae,Ee,be,fe,Be,ke,Ie,we,Le,xe,Ce,je,Pe,Ue,Se,_e,Te,He,qe,De,Fe,ze,Me,Ve,We,Oe,Re,Xe,Ze,$e,Ge,Je,Ke,Qe,Ye,ea,aa,pa,ta,la,sa,ya,ra,ca,ua,va,ia,oa,na,ma,da,ha,ga,Na,Aa,Ea,ba,fa,Ba,ka,Ia,wa,La,xa){return{layout:Se,data:[{article:{slug:ce,title:ce,alt:"nice image",createAt:"2021.01.22",tags:["web development"],toc:[{id:ue,depth:2,text:ue},{id:ve,depth:2,text:ve},{id:ie,depth:2,text:ie},{id:oe,depth:3,text:oe},{id:ne,depth:3,text:ne},{id:me,depth:2,text:me}],body:{type:"root",children:[{type:a,tag:"h2",props:{id:ue},children:[{type:a,tag:M,props:{href:"#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:ue}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"我们原来项目中请求API的代码是用公司现有的脚本工具生成的，其原理就是通过 node 访问 swagger 上后端开发暴露的api，根据约定的规则自动生成api请求的代码，如下所示："}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// api.js"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"*"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:ze}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Me}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"*"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:Ve}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:We}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:Oe}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:Se}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Re},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Xe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:Ze}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:de},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"//moduleA.js"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:he}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ne}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Ae},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ee}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:fe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:ke},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ie}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ne}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Ae},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ee}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:fe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:ke},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:$e}]},{type:e,value:de},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"//moduleB.js"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:he}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ne}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Ae},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ee}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:fe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:ke},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ie}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ne}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Ae},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ee}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:fe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Be},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:ke},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:$e}]},{type:e,value:y}]}]}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"其好处就是：可以一键同步api，自动生成代码省去我们的编码工作，api声明和调用规范统一。\n但是它也带来了比较严重的弊端，即无论这个API方法是否被用到，它都会被打包到项目中，增大了项目的体积，影响应用的首屏启动速度。还有就是模块这种设计模式不支持代码分割，调用者必须如下的导入方式才能才能调用API："}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// page.js"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:we}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:we}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:Je}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:he}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:we}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"moduleB"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:Ie}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:we}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:Je}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:Ke}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y}]}]}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"可以见上述这种方式不但调用繁琐，而且也不能启用 webpack 的 tree shaking 只打包使用到的方法。"}]},{type:e,value:y},{type:a,tag:"h2",props:{id:ve},children:[{type:a,tag:M,props:{href:"#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:ve}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"当然重构代码是一种方法，但是项目代码量已经非常盘大，如果这时候重构原来的api模块代码工作量将会非常大，这无疑是不可取的方案。但是改代码确是唯一的解决方案，那么有没有途径可以在打包的时候自动改掉原来的代码写法呢，而不用手动改原来的代码。"}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"当然有了，babel插件提供了可以处理AST的功能，可以在babel-loader 处理的时候修改其抽象语法树，改变其代码的写法。还不了解babel 相关知识的朋友可以看下"},{type:a,tag:M,props:{href:"https://www.babeljs.cn/",rel:["nofollow","noopener","noreferrer"],target:"_blank"},children:[{type:e,value:"官方文档"}]},{type:e,value:"\n主要目的就是将上述的 page.js 的中的代码改写成如下的形式:"}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:" methodA"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Qe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ye}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:ea},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:aa}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:he}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ie}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Ke}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:de}]}]}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"写成这种形式就可以被webpack的 tree shaking 所处理，只会打包用到的代码。"}]},{type:e,value:y},{type:a,tag:"h2",props:{id:ie},children:[{type:a,tag:M,props:{href:"#%E5%A4%84%E7%90%86%E6%AD%A5%E9%AA%A4%E4%B8%8E%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:ie}]},{type:e,value:y},{type:a,tag:"h3",props:{id:oe},children:[{type:a,tag:M,props:{href:"#%E5%A4%84%E7%90%86%E6%AD%A5%E9%AA%A4",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:oe}]},{type:e,value:y},{type:a,tag:"ul",props:{},children:[{type:e,value:y},{type:a,tag:"li",props:{},children:[{type:e,value:"1、找到导入的 API 变量名"}]},{type:e,value:y},{type:a,tag:"li",props:{},children:[{type:e,value:"2、找到调用的API的模块名称，并收集每个模块下所调用的方法，moduleA: methodA,methodC"}]},{type:e,value:y},{type:a,tag:"li",props:{},children:[{type:e,value:"3、替换调用的方法，即替换函数表达式，API.moduleA.methodA() 换成 methodA()"}]},{type:e,value:y},{type:a,tag:"li",props:{},children:[{type:e,value:"4、 删掉原来的import API 的语句，改成从对应的模块里导出使用到的方法。"}]},{type:e,value:y}]},{type:e,value:y},{type:a,tag:"h3",props:{id:ne},children:[{type:a,tag:M,props:{href:"#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:ne}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 存储API的变量名"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:"let"}]},{type:e,value:_e},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"''"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 存储用到的模块以及对应的方法，格式如下："}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"/*{\n    moduleA: ['methodA1', 'methodA2'],\n    moduleB: ['methodB1', 'methodB2'],\n}*/"}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:"let"}]},{type:e,value:" moduleMap "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Te}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:Le}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"if"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:Le},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"object"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:xe},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:pa},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Te}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:Le},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"object"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:xe},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:pa},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"?"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,Ce]},children:[{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:"result"},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"-"}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:Le},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"property"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:He}]},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"''"}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"else"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:xe},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:" obj"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:He}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"==="}]},{type:e,value:_e},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"?"}]},{type:e,value:_e},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"''"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:"\n\nmodule"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,"method-variable","function-variable",b,c,h]},children:[{type:e,value:"exports"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:c}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:"babel"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:"\n        types"},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:" t\n    "},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" babel"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:V}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:"\n        visitor"},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,c]},children:[{type:a,tag:p,props:{className:[t,je]},children:[{type:e,value:"ImportDeclaration"}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:Pe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 获取导入的 API 变量名"}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:" specifier "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" path"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:re}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:ta}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:a,tag:p,props:{className:[t,"number"]},children:[{type:e,value:"0"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:" value"},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:" pathValue "},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" path"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:re}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"source"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 约定 importSource 必须为 @/api"}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"if"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"pathValue "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"==="}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ge}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 得到模块的变量名，先保存下来"}]},{type:e,value:"\n                variableName "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" specifier"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"local"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:He}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"//移除相应的import语句"}]},{type:e,value:la},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"remove"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,c]},children:[{type:a,tag:p,props:{className:[t,je]},children:[{type:e,value:sa}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:Pe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 获取api方法的调用链，API-moduleA-methodA，如果不是API调用的表达式则返回空"}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:" apiCallInfo "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:Te}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:Pe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:re}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"callee"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"if"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"apiCallInfo"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:"_"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:" moduleName"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:" methodName"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" apiCallInfo"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"split"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"'-'"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 调用信息先保存下来，方便到最后统一添加import"}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"if"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:ya},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:ra},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"push"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:qe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,L]},children:[{type:e,value:"else"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:ra},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:qe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 替换表达式"}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// API.moduleA.methodA() ---\x3e moduleA_methodA()"}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 前面加个模块名作为前缀，主要就是为了防止，不同模块存在相同的方法名"}]},{type:e,value:la},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"replaceWith"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:a,tag:p,props:{className:[t,je]},children:[{type:e,value:sa}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"\n                    t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:De}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,Ce]},children:[{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"_"}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:qe},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:"\n                        path"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:re}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,h]},children:[{type:e,value:"arguments"}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:_},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,je]},children:[{type:e,value:"Program"}]},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:B}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:"exit"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:Pe}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Fe},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 在遍历退出前统一把import语句添加在代码的最前面"}]},{type:e,value:Fe},{type:a,tag:p,props:{className:[t,"known-class-name","class-name"]},children:[{type:e,value:"Object"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"entries"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:ya},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"forEach"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:R}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:ca},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:X}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,"arrow",u]},children:[{type:e,value:"=>"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:" importSource "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,Ce]},children:[{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"../api/"}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:".js"}]},{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// import声明"}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:" specifiers "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:ca},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"map"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,P]},children:[{type:e,value:b}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,"arrow",u]},children:[{type:e,value:"=>"}]},{type:e,value:"\n                        t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"importSpecifier"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:De}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,Ce]},children:[{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:Z},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"_"}]},{type:a,tag:p,props:{className:[t,W]},children:[{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:O}]},{type:e,value:b},{type:a,tag:p,props:{className:[t,I,l]},children:[{type:e,value:n}]}]},{type:a,tag:p,props:{className:[t,F,m]},children:[{type:e,value:z}]}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:"t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:De}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:b},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"//创建导入语句"}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,r]},children:[{type:e,value:H}]},{type:e,value:" importDeclaration "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:" t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:ua}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:ta},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:"t"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"stringLiteral"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:e,value:"importSource"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:$},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 插入到代码最前面"}]},{type:e,value:"\n                    path"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:d}]},{type:a,tag:p,props:{className:[t,b,c,h]},children:[{type:e,value:"unshiftContainer"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"'body'"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:ua},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:Fe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:e,value:"\n                  moduleMap "},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:k}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:x},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:ye},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:xe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:e,value:de}]}]}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"经过该babel插件打包后结果代码如下所示："}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:" methodA "},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:" moduleA_methodA"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Qe},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:" moduleA_methodC"},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Ye}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:ea},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:" moduleB_methodB "},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:aa}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:"moduleA_methodA"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:"moduleB_methodB"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,c]},children:[{type:e,value:"moduleA_methodC"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:v}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:i}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y}]}]}]},{type:e,value:y},{type:a,tag:"h2",props:{id:me},children:[{type:a,tag:M,props:{href:"#%E9%81%97%E7%95%99%E9%97%AE%E9%A2%98",ariaHidden:G,tabIndex:J},children:[{type:a,tag:p,props:{className:[K,Q]},children:[]}]},{type:e,value:me}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"虽然我们使用babel 初步完成了包优化，上述的代码还是有点局限性的，例如 import 的source 必须要写成‘@/api’的形式，而不支持相对路径（'../../api'）的写法。还有就是要求API 里定义的模块名称和模块文件名称不一致也会出现问题，例如："}]},{type:e,value:y},{type:a,tag:Y,props:{className:[ee]},children:[{type:a,tag:ae,props:{className:[pe,te]},children:[{type:a,tag:f,props:{},children:[{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"*"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:ze}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:Me}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,q]},children:[{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"*"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:Ve}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:We}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:U}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,u]},children:[{type:e,value:"*"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:D}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:"C"}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:S}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,m]},children:[{type:e,value:"'./moduleC.js'"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:Oe}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:le}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,r,g]},children:[{type:e,value:Se}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:N}]},{type:e,value:Re},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:Xe},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,se]},children:[{type:e,value:"C"}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:E}]},{type:e,value:s},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:"// 该命名就会导致出错"}]},{type:e,value:w},{type:a,tag:p,props:{className:[t,A]},children:[{type:e,value:Ze}]},{type:e,value:y},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:n}]},{type:a,tag:p,props:{className:[t,l]},children:[{type:e,value:o}]},{type:e,value:y}]}]}]},{type:e,value:y},{type:a,tag:T,props:{},children:[{type:e,value:"针对这些问题，除了批量替换和规范约定外，还是可以写一个eslint插件，自定义校验该语法，如果发现不合理的写法可以直接报错。"}]}]},dir:"/",path:"/使用AST，实现项目包优化",extension:".md",createdAt:va,updatedAt:va}}],fetch:[],error:null,state:{tagList:[{name:"AST",count:2},{name:"生活",count:1},{name:ia,count:1},{name:"学习",count:1},{name:"项目",count:1},{name:"小程序开发",count:1},{name:"前端",count:2},{name:"游戏",count:1},{name:"读书",count:2},{name:"移动端",count:1},{name:"工作",count:1},{name:re,count:1}],yearList:[{year:"2021",monthList:[{month:"8",articleList:[{createAt:"08.22",theme:f,linkUrl:C,title:oa}]},{month:"3",articleList:[{createAt:"03.27",theme:j,linkUrl:C,title:na},{createAt:"03.03",theme:f,linkUrl:C,title:ma}]},{month:"2",articleList:[{createAt:"02.01",theme:j,linkUrl:C,title:da}]},{month:"1",articleList:[{createAt:"01.22",theme:f,linkUrl:C,title:ce}]}]},{year:"2020",monthList:[{month:"12",articleList:[{createAt:"12.18",theme:j,linkUrl:C,title:ha}]},{month:"11",articleList:[{createAt:"11.18",theme:f,linkUrl:ga,title:Na}]},{month:"8",articleList:[{createAt:"08.31",theme:j,linkUrl:C,title:Aa}]},{month:"5",articleList:[{createAt:"05.12",theme:f,linkUrl:C,title:Ea}]},{month:"2",articleList:[{createAt:"02.03",theme:j,linkUrl:C,title:ba}]}]},{year:"2019",monthList:[{month:"11",articleList:[{createAt:"11.01",theme:Ue,linkUrl:C,title:fa}]},{month:"6",articleList:[{createAt:"06.12",theme:f,linkUrl:Ba,title:ka}]},{month:"4",articleList:[{createAt:"04.21",theme:j,linkUrl:C,title:Ia}]},{month:"2",articleList:[{createAt:"02.12",theme:Ue,linkUrl:C,title:wa}]},{month:"1",articleList:[{createAt:"01.12",theme:f,linkUrl:La,title:xa}]}]}],articleList:[{time:"2021-08-22",theme:f,title:oa,tag:"AST",desc:"本篇文章介绍的是如何在yapi平台上自动生成ts代码"},{time:"2021-03-27",theme:j,title:na,tag:"生活",desc:"生活中经常会感到焦虑，认清焦虑的来源，以及如何去克服它"},{time:"2021-03-03",theme:f,title:ma,tag:ia,desc:"平时开发过程中会经常涉及到服务端API的调用，调用API的函数无法设置返回值的类型，因为是动态的依赖。所以给开发者带来了一定的困扰"},{time:"2021-02-01",theme:j,title:da,tag:"学习",desc:"从18年开始就有写博客的意识了，但是确很难坚持去写，自己总会拿种种原因逃避写博客，去年因为项目太忙就停止了，直到最近读了《软技能2》才意识到写博客的重要性。"},{time:"2021-01-22",theme:f,title:ce,tag:"AST",desc:"写了一个babel插件，进行语法的转化，利用 webpack tree shaking 的特性实现包体积的优化"},{time:"2020-12-18",theme:j,title:ha,tag:"项目",desc:"给Volvo主机厂商做的项目终于上线了，长达十个月之久的攻坚战到此落下帷幕，从项目中总结出一些经验方便日后参考与回顾。"},{time:"2020-11-18",theme:f,title:Na,tag:"小程序开发",desc:"一直想找机会想做微信小程序的项目，今年终于如愿以偿，耗时十个月，带领团队给volvo主机厂商做了个功能非常复杂的C端小程序，借这篇文章总结下开发小程序坑点以及对应的解决方案",linkUrl:ga},{time:"2020-08-31",theme:j,title:Aa,tag:"前端",desc:"今年团队转型做交付型的项目，规模扩充了许多。我也被分配到某一项目线，担任前端团队的Leader。着算是我第一次带领团队做项目，可谓充满着压力与挑战。作为一个TL除了有较强的技术能力之外，还需要掌握其他重要的技能。"},{time:"2020-05-12",theme:f,title:Ea,tag:"前端",desc:"图片懒加载是前端老生长谈的话题，聊聊自己的实践总结"},{time:"2020-02-03",theme:j,title:ba,tag:"游戏",desc:"《全面战争·三国》是去年6月份刚刚出的一款大型策略类游戏，趁着疫情隔离在家体验了好好体验了一把，通关后有了一些感悟。"},{time:"2019-11-01",theme:Ue,title:fa,tag:"读书",desc:"树立起理财观念的一一本启蒙书，强烈推荐阅读"},{time:"2019-06-12",theme:f,title:ka,tag:"移动端",desc:"众所周知，进行移动端响应式开发，无非就是用 vw 和 rem 作为像素单位进行样式布局, 现在比较流行的是 vw 和 vh，自动根据浏览器的屏幕宽度和高度进行适配，不用像 rem 需要手动设置html的fontSize。请认真看下去，好戏再最后头😎",linkUrl:Ba},{time:"2019-04-21",theme:j,title:Ia,tag:"工作"},{time:"2019-02-12",theme:Ue,title:wa,desc:"一本讲关于如何养成高质量睡眠的书，记录了书中的一些要点",tag:"读书"},{time:"2019-01-12",theme:f,title:xa,tag:re,linkUrl:La}],options:{isAsidePage:!1,isError:!1,mobileLayout:!1,mobileSidebar:!1,userAgent:"",adminInfo:{gravatar:"/images/me.jpg"},option:{},isWelcome:!0,pageLoading:!1}},serverRendered:!0,routePath:"/blogs/%E4%BD%BF%E7%94%A8AST%EF%BC%8C%E5%AE%9E%E7%8E%B0%E9%A1%B9%E7%9B%AE%E5%8C%85%E4%BC%98%E5%8C%96",config:{content:{dbHash:"650c8ae5"}}}}("text","element","span","token","punctuation"," ","\n","keyword","function","operator","(",")",";","}","string",".","property-access","module","{","comment",",","method","code",":","=","interpolation-punctuation","\n    ","control-flow","\n                ",void 0,"think","parameter","import","from","\n              ","p","const","imports","as","template-punctuation","`","a","return","interpolation","${","[","]","moduleName","\n                    ","true",-1,"icon","icon-link","div","nuxt-content-highlight","pre","language-js","line-numbers","export","constant","\n            ","node","使用AST，实现项目包优化","问题背景","解决方案","处理步骤与核心代码","处理步骤","核心代码","遗留问题","\n\n","methodA","opts","instance","\n        method","'get'","\n        url","'/carEquity/entry.json'","\n        opts"," opts\n    ","methodB","API","obj","\n        ","template-string","maybe-class-name","path","note","default"," variableName ","getAPICallInfo","name","methodName","identifier","\n                  "," moduleA","'./moduleA.js'"," moduleB","'./moduleB.js'","//... 省略很多module","\n    moduleA","\n    moduleB","//....省略很多module","//... 省略很多method","'@/api'","moduleA","methodC"," methodC ","'@/api/moduleA.js'"," methodB ","'@/api/moduleB.js'"," result ","specifiers","\n                path","CallExpression","moduleMap","\n                    moduleMap"," methods","importDeclaration","2022-03-29T01:18:22.975Z","TypeScript","基于AST在yapi平台下自动生成代码","为什么我会感到焦虑","使用TS泛型优雅地调用axios","为什么要坚持写博客","项目上线后的总结感悟","https://www.yuque.com/fecyrm/uyzotu/dwxdt8","微信小程序实践总结","首次担任TL的感受","图片懒加载的实践方案","沉迷于《全面战争·三国》","《穷爸爸，富爸爸》读后感","https://www.yuque.com/fecyrm/uyzotu/xkqnsn","优雅地进行移动端适配","到底该不该换工作","《睡眠革命》读书笔记","https://www.yuque.com/fecyrm/uyzotu/ulqs3c","如何用node写一个自动化发布工具")</script><script src="/_nuxt/e88f8e6.js" defer></script><script src="/_nuxt/f0fcb16.js" defer></script><script src="/_nuxt/2db4bdf.js" defer></script><script src="/_nuxt/b1d70db.js" defer></script><script src="/_nuxt/87fba30.js" defer></script><script src="/_nuxt/0ec0951.js" defer></script>
  </body>
</html>
